import mysql.connector
#database connection
conn = mysql.connector.connect(host =" localhost ", port = 3306 , user = "root", passwd = "")

def db_create_db(conn):
    mycursor = conn.cursor()
    mycursor.execute( "CREATE DATABASE IF NOT EXISTS db_notes")

db_create_db(conn)

#create table
def db_create_table(conn):
    db_create_db(conn)
    conn.database = "db_notes"
    mycursor = conn.cursor()
    query = "CREATE TABLE IF NOT EXISTS tb_notes(" \
        "notes_id INT AUTI_INCREMENT PRIMARY KEY, "\
        "title VARCHAR (255) NOT NULL, "\
        "note VARCHAR (2000) NOT NULL"
    mycursor.execute(query)

db_create_table(conn)
#insert data function
def db_insert_note(conn, title, note):
    conn.database = "db_notes"
    mycursor = conn.cursor()
    query = "INSERT INTO tb_notes (title, note) VALUES (%s, %s)"
    val = (title, note)
    mycursor.execute(query, val)
    conn.commit()
    return mycursor.lastrowid

records = [
        ('First title', 'first note'),
        ('Second title', 'second note'),
        ('Third title', 'third note'),
        ('Fourth title', 'fourth note'),
        ('Fifth title', 'fifth note')
    ]

for v in records:
    db_insert_note(conn, v[0], v[1]) 
#select from db
def db_select_all_notes(conn):
    conn.database = "db_notes"
    query = "SELECT * from tb_notes"
    mycursor = conn.cursor()
    mycursor.execute(query)
    return mycursor.fetchall()

def db_select_specific_note(conn, note_id):
    conn.database = "db_notes"
    mycursor = conn.cursor()
    mycursor.execute("SELECT title, note FROM tb_notes WHERE note_id = " + str(note_id))
    return mycursor.fetchone()

print("=====Select all the records =====")
data = db_select_all_notes(conn) 
for d in data:
    print (d)

print("=====Selecting record where note_id is 2 =====")
print(db_get_specific_note(conn, 2))

